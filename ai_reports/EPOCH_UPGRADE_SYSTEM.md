# 时代升级系统 (Epoch Upgrade System)

## 📖 系统概述

时代升级系统是游戏的核心进程机制，类似于《帝国时代》中的时代升级功能。玩家通过满足特定条件并消耗资源，可以将文明推进到更高的时代，解锁新的建筑、科技和全局加成。

## 🎯 设计目标

1. **明确的进程目标** - 为玩家提供清晰的短期和长期目标
2. **资源管理挑战** - 需要平衡当前发展和未来升级
3. **显著的奖励感** - 升级后获得强大的全局加成
4. **视觉反馈** - 时代变化带来明显的UI和视觉变化

## 🏛️ 时代列表

### 石器时代 (Epoch 0)
- **解锁条件**: 游戏开始
- **升级成本**: 无
- **时代特色**: 文明的起源，一切从这里开始
- **可用建筑**: 农田、伐木场、采石场、简陋小屋、锯木厂、图书馆
- **可用科技**: 基础工具、车轮

### 青铜时代 (Epoch 1)
- **解锁条件**:
  - 科研 ≥ 500
  - 人口 ≥ 20
- **升级成本**:
  - 粮食: 500
  - 木材: 300
  - 石料: 100
  - 黄金: 50
- **时代加成**:
  - 采集效率 +15%
  - 军事力量 +10%
- **新解锁**: 庄园、木屋、兵营、教堂、砖窑、深井矿、市场
- **新科技**: 封建制度、神学

### 封建时代 (Epoch 2)
- **解锁条件**:
  - 科研 ≥ 2000
  - 人口 ≥ 100
  - 文化 ≥ 500
- **升级成本**:
  - 粮食: 2000
  - 木材: 1000
  - 石料: 500
  - 黄金: 200
  - 木板: 200
- **时代加成**:
  - 采集效率 +25%
  - 文化产出 +20%
  - 行政容量 +5
- **新解锁**: 市政厅
- **新科技**: 官僚制度

### 工业时代 (Epoch 3)
- **解锁条件**:
  - 科研 ≥ 10000
  - 人口 ≥ 500
  - 文化 ≥ 2000
- **升级成本**:
  - 粮食: 5000
  - 砖块: 1000
  - 铁矿: 500
  - 黄金: 500
  - 木板: 500
- **时代加成**:
  - 采集效率 +40%
  - 工业产出 +50%
  - 科研产出 +30%
- **新解锁**: 工厂
- **新科技**: 工业化

### 信息时代 (Epoch 4)
- **解锁条件**:
  - 科研 ≥ 50000
  - 人口 ≥ 2000
  - 文化 ≥ 10000
- **升级成本**:
  - 粮食: 10000
  - 砖块: 2000
  - 铁矿: 1000
  - 黄金: 1000
  - 工具: 500
- **时代加成**:
  - 采集效率 +60%
  - 工业产出 +80%
  - 科研产出 +50%
  - 文化产出 +40%
- **特色**: 最终时代，全面发展

## 🎮 使用方法

### 查看升级条件
1. 点击主界面的"科技"标签页
2. 在页面顶部会看到醒目的"时代升级"区域
3. 显示当前时代和下一时代信息

### 升级准备
升级区域会实时显示：
- ✅ **升级条件**: 科研、人口、文化等要求（绿色表示已满足，红色表示未满足）
- 💰 **升级成本**: 需要消耗的各类资源
- 🎁 **时代加成**: 升级后获得的全局加成效果

### 执行升级
1. 当所有条件都满足时，"升级"按钮会高亮并闪烁
2. 点击按钮即可升级到下一时代
3. 升级后：
   - 立即扣除所有升级成本
   - 解锁新的建筑和科技
   - 应用全局加成效果
   - 界面背景色会改变
   - 日志中显示升级消息

## 💡 策略建议

### 早期策略 (石器→青铜)
- 优先建造图书馆积累科研
- 建造简陋小屋增加人口上限
- 保持粮食和木材的稳定产出
- 不要过早升级，确保资源充足

### 中期策略 (青铜→封建)
- 平衡科研和文化发展
- 建造教堂产出文化
- 扩大人口规模
- 开始建立产业链（木板、砖块）

### 后期策略 (封建→工业)
- 大规模工业化生产
- 建造工厂提升产能
- 注意行政容量管理
- 积累大量资源准备最终升级

## 🔧 技术实现

### 数据结构
```javascript
EPOCHS = [
  {
    id: 0,
    name: "石器时代",
    req: { science: 0 },           // 解锁条件
    cost: {},                       // 升级成本
    bonuses: {                      // 全局加成
      desc: "描述",
      gatherBonus: 0.15,           // 采集加成
      industryBonus: 0.5,          // 工业加成
      scienceBonus: 0.3,           // 科研加成
      cultureBonus: 0.2,           // 文化加成
      adminBonus: 5                // 行政容量加成
    }
  }
]
```

### 核心函数
- `canUpgradeEpoch()` - 检查是否满足升级条件
- `upgradeEpoch()` - 执行升级操作
- `simulateTick()` - 应用时代加成到生产计算

### 加成应用机制
1. **采集加成** - 应用于所有 `cat: 'gather'` 类建筑
2. **工业加成** - 应用于所有 `cat: 'industry'` 类建筑
3. **科研加成** - 应用于所有产出 `science` 的建筑
4. **文化加成** - 应用于所有产出 `culture` 的建筑
5. **行政加成** - 直接增加行政容量上限

## 🎨 UI设计特点

1. **醒目的升级区域** - 使用渐变背景和边框高亮
2. **实时条件显示** - 用颜色区分已满足/未满足的条件
3. **加成预览** - 清晰展示升级后的收益
4. **动画效果** - 可升级时按钮会闪烁吸引注意
5. **背景变化** - 每个时代有独特的配色方案

## 🐛 已知问题和未来改进

### 当前版本
- ✅ 基础升级系统完成
- ✅ 全局加成应用
- ✅ UI界面完善
- ✅ 条件检查和资源扣除

### 未来改进方向
- [ ] 添加升级动画效果
- [ ] 升级时播放音效
- [ ] 添加升级确认对话框
- [ ] 时代升级成就系统
- [ ] 不同时代的特殊事件
- [ ] 时代相关的外交选项

## 📝 更新日志

### v1.0.0 (2025-11-21)
- 初始版本发布
- 实现5个时代的完整升级系统
- 添加全局加成机制
- 完成UI界面设计
