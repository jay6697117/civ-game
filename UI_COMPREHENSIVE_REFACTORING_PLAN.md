# 文明崛起 - 全面UI重构计划

## 📋 问题清单

### 1. 移动端顶部控制栏问题 ❌
**问题描述**：
- 暂停、加速、保存、帮助按钮在移动端完全脱离状态栏之外
- 移动端GameControls浮动在右上角，位置不合理
- 与StatusBar重叠，用户体验差

**解决方案**：
- 将移动端GameControls集成到StatusBar内部
- 使用折叠式设计，默认只显示最关键的控制（暂停/速度）
- 其他功能放入下拉菜单

### 2. EmpireScene占用空间问题 ❌
**问题描述**：
- 移动端为了显示EmpireScene挤占了大量空间
- 移动端不显示各阶级信息

**解决方案**：
- 将EmpireScene放入可折叠的Tab中
- 点击后以浮动卡片形式显示
- 移动端添加阶级信息的快速访问入口

### 3. 建设界面卡片臃肿 ❌
**问题描述**：
- 建筑卡片过大，需要大量滑动
- 建造成本高时，按钮文本显示错位
- 信息显示不简洁

**解决方案**：
- 缩小卡片尺寸，使用紧凑布局
- PC端：鼠标悬停显示详细信息的Tooltip
- 移动端：点击显示详细信息的Modal
- 优化按钮文本显示，使用图标+简短文字

### 4. 军事面板卡片臃肿 ❌
**问题描述**：
- 兵种卡片信息显示不简洁
- 需要大量滑动

**解决方案**：
- 缩小卡片尺寸
- PC端：鼠标悬停显示详细信息
- 移动端：点击显示详细信息Modal

### 5. 科技面板问题 ❌
**问题描述**：
- 科技太多且没有多tab选择
- 滑动困难

**解决方案**：
- 添加时代分类Tab
- 缩小科技卡片尺寸
- PC端：鼠标悬停显示详细信息
- 移动端：点击显示详细信息Modal
- 添加搜索/筛选功能

### 6. 政令系统交易税界面问题 ❌
**问题描述**：
- 移动端显示完全不正常
- 像是被某个元素挡住了
- 排版问题严重

**解决方案**：
- 重构交易税界面的布局
- 使用响应式Grid布局
- 确保移动端的滚动容器正确设置
- 参考人头税和营业税的处理方式

### 7. 政令卡片问题 ❌
**问题描述**：
- 政令卡片太多且没有多tab选择
- 滑动困难

**解决方案**：
- 添加类别筛选Tab
- 缩小卡片尺寸
- PC端：鼠标悬停显示详细信息
- 移动端：点击显示详细信息Modal

### 8. 外交界面显示问题 ❌
**问题描述**：
- 国家交互和贸易窗口显示不完全
- 移动端非常难以使用

**解决方案**：
- 移动端使用二级/三级弹窗
- 优化表格布局，使用响应式设计
- 添加横向滚动支持
- 简化移动端的信息显示

### 9. 弹窗z-index问题 ❌
**问题描述**：
- 所有弹窗被顶部栏挡在下面
- 移动端问题更严重
- 弹窗又大又需要滑动

**解决方案**：
- 统一管理z-index层级
- 弹窗使用z-100以上
- 移动端弹窗使用全屏或底部抽屉设计
- 优化弹窗内容布局，减少滚动需求

### 10. 教程弹窗问题 ❌
**问题描述**：
- 移动端显示超出屏幕范围
- 百科内容显示不全

**解决方案**：
- 移动端使用全屏模式
- 优化内容布局
- 添加分页或步骤导航
- 确保所有内容可滚动访问

---

## 🎯 重构策略

### 阶段1：建立统一的设计系统

#### 1.1 创建z-index配置
```javascript
// src/config/zIndex.js
export const Z_INDEX = {
  MODAL: 100,
  MODAL_OVERLAY: 99,
  DRAWER: 90,
  DROPDOWN: 80,
  TOOLTIP: 70,
  GAME_CONTROLS: 60,
  HEADER: 50,
  POPUP: 40,
  STICKY: 30,
  FLOATING: 20,
  BASE: 0,
};
```

#### 1.2 创建响应式断点配置
```javascript
// src/config/breakpoints.js
export const BREAKPOINTS = {
  mobile: '(max-width: 640px)',
  tablet: '(min-width: 641px) and (max-width: 1023px)',
  desktop: '(min-width: 1024px)',
};
```

#### 1.3 创建通用组件

**CompactCard组件**：
- 紧凑的卡片布局
- 支持悬停/点击展开详情
- 响应式设计

**DetailModal组件**：
- 统一的详情弹窗
- 移动端全屏/底部抽屉
- PC端居中模态框

**Tooltip组件**：
- PC端悬停提示
- 移动端不显示（使用点击Modal代替）

### 阶段2：重构各个Tab组件

#### 2.1 BuildTab重构
- 使用CompactCard组件
- 添加Tooltip/Modal详情
- 优化按钮布局

#### 2.2 MilitaryTab重构
- 使用CompactCard组件
- 添加Tooltip/Modal详情
- 优化统计信息显示

#### 2.3 TechTab重构
- 添加时代分类Tab
- 使用CompactCard组件
- 添加搜索功能

#### 2.4 PoliticsTab重构
- 修复交易税界面布局
- 添加类别筛选
- 使用CompactCard组件

#### 2.5 DiplomacyTab重构
- 优化表格布局
- 移动端使用二级弹窗
- 简化信息显示

### 阶段3：重构布局和导航

#### 3.1 StatusBar重构
- 集成移动端GameControls
- 优化信息显示
- 添加快速访问菜单

#### 3.2 Modal系统重构
- 统一z-index管理
- 移动端全屏/底部抽屉
- 优化内容布局

#### 3.3 EmpireScene重构
- 移动端折叠式显示
- 添加快速访问按钮
- 优化动画效果

---

## 📐 设计规范

### 卡片尺寸规范

**紧凑模式（Compact）**：
- 宽度：120-150px
- 高度：100-120px
- 内边距：8px
- 字体：10-12px

**标准模式（Normal）**：
- 宽度：200-250px
- 高度：150-180px
- 内边距：12px
- 字体：12-14px

**详细模式（Detailed）**：
- 宽度：300-400px
- 高度：自适应
- 内边距：16px
- 字体：14-16px

### 响应式布局规范

**移动端（< 640px）**：
- 单列布局
- 紧凑卡片
- 全屏弹窗
- 底部导航

**平板（640px - 1023px）**：
- 2-3列布局
- 标准卡片
- 居中弹窗
- 底部导航

**桌面（≥ 1024px）**：
- 3-4列布局
- 标准卡片
- 居中弹窗
- 顶部导航

### z-index层级规范

```
100+ : 模态框、全屏弹窗
90-99: 抽屉、侧边栏
80-89: 下拉菜单
70-79: Tooltip
60-69: 游戏控制
50-59: 固定头部
40-49: 弹出内容
30-39: 粘性元素
20-29: 浮动元素
0-19 : 普通内容
```

---

## 🚀 实施计划

### 第一步：创建基础组件（1-2小时）
1. 创建z-index配置
2. 创建CompactCard组件
3. 创建DetailModal组件
4. 创建Tooltip组件

### 第二步：重构BuildTab（30分钟）
1. 应用CompactCard
2. 添加详情功能
3. 优化按钮布局

### 第三步：重构MilitaryTab（30分钟）
1. 应用CompactCard
2. 添加详情功能
3. 优化统计显示

### 第四步：重构TechTab（45分钟）
1. 添加时代Tab
2. 应用CompactCard
3. 添加搜索功能

### 第五步：重构PoliticsTab（1小时）
1. 修复交易税布局
2. 添加类别筛选
3. 应用CompactCard

### 第六步：重构DiplomacyTab（45分钟）
1. 优化表格布局
2. 添加二级弹窗
3. 简化信息显示

### 第七步：重构StatusBar和Modal（1小时）
1. 集成移动端控制
2. 统一z-index
3. 优化弹窗布局

### 第八步：测试和优化（1小时）
1. 移动端测试
2. 平板测试
3. 桌面测试
4. 性能优化

**总计时间：约6-7小时**

---

## ✅ 验收标准

### 移动端
- [ ] 顶部控制栏完全可见且可用
- [ ] EmpireScene可折叠，不占用过多空间
- [ ] 所有卡片信息清晰可见
- [ ] 弹窗不超出屏幕范围
- [ ] 滚动流畅，无卡顿
- [ ] 所有功能可正常访问

### 平板
- [ ] 布局合理，信息密度适中
- [ ] 卡片大小适中
- [ ] 弹窗居中显示
- [ ] 导航清晰

### 桌面
- [ ] 充分利用屏幕空间
- [ ] Tooltip功能正常
- [ ] 悬停效果流畅
- [ ] 多列布局合理

### 通用
- [ ] z-index层级正确
- [ ] 无元素遮挡
- [ ] 动画流畅
- [ ] 性能良好
- [ ] 代码结构清晰
- [ ] 易于维护

---

## 📝 注意事项

1. **保持向后兼容**：确保现有功能不受影响
2. **渐进式重构**：一次重构一个组件，避免大规模改动
3. **充分测试**：每个阶段完成后进行测试
4. **性能优先**：避免过度动画和复杂计算
5. **用户体验**：始终以用户体验为中心
6. **代码质量**：保持代码简洁、可读、可维护

---

**创建时间**：2025-11-26  
**预计完成时间**：2025-11-26  
**优先级**：🔴 高
