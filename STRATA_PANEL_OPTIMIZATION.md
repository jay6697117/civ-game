# 阶级面板显示优化说明

## 问题描述

当游戏中阶级数量过多时（最多可达17个阶级），左侧的阶级面板无法完整显示所有阶级，导致部分内容被截断或隐藏。

## 优化方案

### 1. 布局结构优化

#### 1.1 使用Flexbox布局
- 将面板容器改为 `flex flex-col` 布局
- 标题区域设置为 `flex-shrink-0`，确保不被压缩
- 阶级列表区域设置为 `flex-1`，自动占据剩余空间
- 底部按钮和效果区域设置为 `flex-shrink-0`，固定高度

#### 1.2 动态高度计算
- 阶级列表区域使用 `maxHeight: 'calc(100vh - 520px)'` 动态计算高度
- 设置 `minHeight: '300px'` 确保最小可用空间
- 根据视口高度自适应调整，充分利用屏幕空间

### 2. 阶级卡片紧凑化

#### 2.1 减少内边距和间距
- 卡片内边距从 `p-2` 减少到 `p-1.5`
- 卡片间距从 `space-y-1.5` 减少到 `space-y-1`
- 各元素间距从 `mb-1` 减少到 `mb-0.5`

#### 2.2 信息合并显示
**原布局：**
- 第1行：阶级名称 + 人口
- 第2行：好感度标签 + 数值
- 第3行：好感度进度条
- 第4行：影响力标签 + 数值
- 第5行：财富标签 + 数值 + 变化

**优化后：**
- 第1行：图标 + 阶级名称 + 人口 + 好感度数值
- 第2行：好感度进度条
- 第3行：影响力 + 数值 | 财富图标 + 数值 + 变化
- 第4行（如有）：短缺资源提示

**高度减少：** 每个卡片从约 100px 减少到约 50px，节省约 50% 空间

#### 2.3 字体和图标尺寸优化
- 阶级名称：保持 `text-xs` (12px)
- 人口数量：`text-[10px]` (10px)
- 好感度数值：`text-[10px]` (10px)
- 影响力/财富：`text-[10px]` (10px)
- 图标尺寸：从 14px 减少到 10-12px
- 进度条高度：从 `h-1.5` 减少到 `h-1`

### 3. 滚动条优化

#### 3.1 自定义滚动条样式
在 `index.css` 中添加了自定义滚动条样式：

```css
/* Webkit浏览器（Chrome, Safari, Edge） */
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;  /* 细滚动条 */
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-track-gray-800::-webkit-scrollbar-track {
  background: #1f2937;  /* 深色轨道 */
  border-radius: 3px;
}

.scrollbar-thumb-gray-600::-webkit-scrollbar-thumb {
  background: #4b5563;  /* 灰色滑块 */
  border-radius: 3px;
}

.hover\:scrollbar-thumb-gray-500:hover::-webkit-scrollbar-thumb {
  background: #6b7280;  /* 悬停时变亮 */
}

/* Firefox */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: #4b5563 #1f2937;
}
```

#### 3.2 应用滚动条样式
- 阶级列表区域：`scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800 hover:scrollbar-thumb-gray-500`
- 当前效果区域：同样应用自定义滚动条样式

### 4. 当前效果区域优化

#### 4.1 尺寸优化
- 标题字体：从 `text-xs` 减少到 `text-[10px]`
- 标题图标：从 14px 减少到 12px
- 效果文字：从 `text-xs` 减少到 `text-[10px]`
- 效果详情：`text-[9px]`
- 效果图标：从 12px 减少到 10px
- 最大高度：从 `max-h-24` 减少到 `max-h-20`

#### 4.2 间距优化
- 上边距：从 `mt-2` 减少到 `mt-1.5`
- 上内边距：从 `pt-2` 减少到 `pt-1.5`
- 标题下边距：从 `mb-1.5` 减少到 `mb-1`
- 效果间距：从 `space-y-1` 减少到 `space-y-0.5`

### 5. 查看详情按钮优化

- 字体大小：从 `text-xs` 减少到 `text-[10px]`
- 图标大小：从 12px 减少到 10px
- 内边距：从 `px-3 py-1.5` 减少到 `px-2 py-1`
- 上边距：从 `mt-2` 减少到 `mt-1.5`

## 优化效果

### 空间利用率提升
- **阶级卡片高度减少约 50%**：从约 100px 减少到约 50px
- **可显示阶级数量增加**：
  - 优化前：固定高度 420px，约可显示 4-5 个阶级
  - 优化后：动态高度 `calc(100vh - 520px)`，在 1080p 屏幕上约可显示 10-12 个阶级
- **滚动体验改善**：自定义滚动条更美观，滚动更流畅

### 信息密度提升
- 通过合并显示行，在更小空间内展示相同信息
- 保持了所有关键信息的可读性
- 视觉层次清晰，重要信息突出

### 响应式适配
- 使用 `calc(100vh - 520px)` 动态计算高度
- 在不同屏幕尺寸下自动调整
- 设置最小高度 300px 确保小屏幕下的可用性

## 技术实现

### 修改的文件

1. **src/components/panels/StrataPanel.jsx**
   - 优化组件布局结构
   - 紧凑化阶级卡片显示
   - 优化当前效果和按钮区域

2. **src/index.css**
   - 添加自定义滚动条样式
   - 支持 Webkit 和 Firefox 浏览器

### 关键技术点

1. **Flexbox 布局**：使用 `flex flex-col` 实现垂直弹性布局
2. **CSS calc() 函数**：动态计算可用高度
3. **自定义滚动条**：使用 `::-webkit-scrollbar` 伪元素和 `scrollbar-width` 属性
4. **Tailwind CSS 工具类**：使用任意值语法 `text-[10px]` 实现精确控制

## 兼容性

- ✅ Chrome/Edge (Chromium)
- ✅ Safari
- ✅ Firefox
- ✅ 响应式设计，支持各种屏幕尺寸

## 后续优化建议

1. **虚拟滚动**：如果阶级数量超过 20 个，可考虑实现虚拟滚动以提升性能
2. **折叠/展开**：为每个阶级添加折叠功能，只显示关键信息
3. **分组显示**：按阶级类型（下层/中层/上层）分组显示
4. **搜索/筛选**：添加搜索框，快速定位特定阶级
5. **自定义显示**：允许用户自定义显示哪些信息字段

## 测试建议

1. 在游戏中创建所有 17 个阶级，验证显示效果
2. 测试不同屏幕尺寸下的显示效果（1080p, 1440p, 4K）
3. 测试滚动流畅度和响应性
4. 验证所有信息的可读性和可点击性
5. 测试不同浏览器的兼容性

---

**优化完成时间：** 2025-11-22  
**优化版本：** v1.0  
**相关文件：** StrataPanel.jsx, index.css
